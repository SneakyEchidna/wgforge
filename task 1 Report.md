Начнем решение поставленной задачи с подгрузки списка команд и их рейтингов из файла `teams.txt`. 

Для получения рейтинга команд мы используем `id` игрока как индекс строки для файла `players.txt` и по нему найдём рейтинг игрока и добавим его к общему рейтингу команды. Так мы избежим загрузки в память игроков, которые в данный момент не участвуют в подборе команд.

После получения командных рейтингов мы отсортируем список команд по рейтингу. Теперь мы можем пройти по списку с шагом в две команды и подобрать максимально близкие по рейтингу.

Дополнительно проверим количество команд на четность, чтобы в случае отсутствия пары для последней команды оставить её в одиночестве. 
